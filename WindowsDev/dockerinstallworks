//Step 1: Install the Windows Containers feature
Write-Host "Installing Windows Containers feature..."
Install-WindowsFeature -Name Containers

//Step 2: Enable the Hyper-V feature (required for WSL 2)
Write-Host "Installing Hyper-V feature..."
Install-WindowsFeature -Name Hyper-V -IncludeManagementTools

//Step 3: Install WSL 2
Write-Host "Installing WSL 2..."
wsl --set-default-version 2

//Step 4: Install the Ubuntu distribution for WSL (optional but recommended for Docker CLI usage)
Write-Host "Installing Ubuntu from the Microsoft Store (WSL distro)..."
wsl --install -d Ubuntu

//Step 5: Check if Chocolatey is installed (If not, install it)
Write-Host "Checking if Chocolatey is installed..."
if (-not (Get-Command choco -ErrorAction SilentlyContinue)) {
    Write-Host "Chocolatey not found. Installing Chocolatey..."
    Set-ExecutionPolicy Bypass -Scope Process -Force
    Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
} else {
    Write-Host "Chocolatey is already installed."
}

//Step 6: Install Docker Engine CLI using Chocolatey
Write-Host "Installing Docker CLI using Chocolatey..."
choco install docker-cli -y

//Step 7: Enable and start Docker service
Write-Host "Enabling and starting Docker service..."
Start-Service Docker
Set-Service -Name Docker -StartupType Automatic

//Step 8: Verify Docker installation (to confirm Docker is working with WSL 2)
Write-Host "Verifying Docker version..."
docker --version

Write-Host "Docker installation with WSL 2 completed successfully!"
